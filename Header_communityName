(function () {

  function getParam(name) {
    return new URL(window.location.href).searchParams.get(name) || "";
  }

  const community = getParam("community");
  if (!community) return;

  function headerStable(header) {
    const children = header.children;
    return children.length >= 3;
  }

  function rewriteHeader() {

    const header = document.querySelector(".pre-content");
    if (!header) {
      requestAnimationFrame(rewriteHeader);
      return;
    }

    // מחכים שאוריגמי יסיים לבנות
    if (!headerStable(header)) {
      requestAnimationFrame(rewriteHeader);
      return;
    }

    if (header.innerHTML.includes("community-header")) return;

    const img = header.querySelector("img");
    if (!img) return;

    header.innerHTML = `
      <div>${img.outerHTML}</div>
      <div id="community-header" style="
        text-align:center;
        font-weight:bold;
        color:#1f5fa8;
        margin:6px 0;
        padding:0 10px;
        line-height:1.2;
        font-size:clamp(16px,5vw,30px);
        word-break:break-word;
      ">
        רישום לקהילת ${community}
      </div>
    `;
  }

  rewriteHeader();

})();
